<!DOCTYPE html>
<html lang="sk">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<title>SZH - index</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="" />
	<meta name="keywords" content="" />
	<meta name="copyright" content="Unionsoft" />
	<meta name="author" content="" />
	
	<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link rel="stylesheet" type="text/css" href="/portal/css/standalone.css">
	<link rel="stylesheet" type="text/css" href="/portal/css/portal.css">
	<link rel="stylesheet" type="text/css" href="/portal/css/font-awesome.min.css">
	<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
</head>

<body>
	<div id="portal-main-container">
		<div id="portal-header-container">
			<header id="portal-main-header">
				<h1>Slovenský Zväz Hádzanej</h1>
				<img class="portal-logo" src="/portal/img/portal-logo.png" alt="logo" title="SLOVENSKÝ ZVÄZ HÁDZANEJ" />
			</header>
		</div>
		<div id="portal-club-logos-panel-container">
			<div id="portal-club-logos-panel">
				<div class="portal-club-logo portal-club-logo-1"></div>
				<div class="portal-club-logo portal-club-logo-2"></div>
				<div class="portal-club-logo portal-club-logo-3"></div>
				<div class="portal-club-logo portal-club-logo-4"></div>
				<div class="portal-club-logo portal-club-logo-5"></div>
				<div class="portal-club-logo portal-club-logo-6"></div>
				<div class="portal-club-logo portal-club-logo-7"></div>
				<div class="portal-club-logo portal-club-logo-8"></div>
				<div class="portal-club-logo portal-club-logo-9"></div>
				<div class="portal-club-logo portal-club-logo-10"></div>
				<div class="portal-club-logo portal-club-logo-11"></div>
				<div class="portal-club-logo portal-club-logo-12"></div>
				<div class="portal-club-logo portal-club-logo-13"></div>
				<div class="portal-club-logo portal-club-logo-14"></div>
			</div>
		</div>
		<div id="portal-menu-panel-container">
			{% block menu %}
				<div id="portal-menu-panel">
					{%for k in menu %}
						<div class="portal-menu-entry"><a href="/article/{{k.aid}}">{{k.name}}</a>
							<div class="portal-sub-menu">
								{% for s in k.subElements %}
									<div><a href="/article/{{s.aid}}">{{s.name}}</a></div>
								{% endfor %}
							</div>
						</div>
					{% endfor %}
				</div>
			{% endblock menu %}
		</div>
		<div id="portal-content-container">
			<div id="portal-main-content">
				<article id="portal-article">
					{% for widget in article.data %}
						{% set templatePath = "widgets/" + widget.meta.type + ".widget" %}
						{% include templatePath with widget only %}
					{% endfor %}
				</article>
			</div>
			<div id="portal-side-content">
				<section class="portal-side-panel">
					<a href="http://huncro2014.ehf-euro.com/home/"><img src="/portal/img/2014EWHC.jpg"></img></a>
				</section>
				<section class="portal-side-panel x-portal-competition-matches">
					<header>Výsledky</header>
					<div style="width:100%;"><select style="width:100%; padding-top: 5px; padding-bottom: 5px; padding-left: 36px; margin-top: 5px; margin-bottom: 5px;" class="x-portal-competition-selector"></select></div>

					<table style="width: 100%;">
					</table>
				</section>
				<section class="portal-side-panel x-portal-competition-results">
					<header>Poradie</header>
					<div style="width:100%;"><select style="width:100%; padding-top: 5px; padding-bottom: 5px; padding-left: 36px; margin-top: 5px; margin-bottom: 5px;" class="x-portal-competition-selector"><option>Extraliga - Muži</option></select></div>

					<table style="width:100%; padding-top: 1px;" class="rowtable">
					</table>
				</section>
				<section class="portal-side-panel">
					<iframe src="//www.facebook.com/plugins/likebox.php?href=https%3A%2F%2Fwww.facebook.com%2FSlovenskyZvazHadzanej&amp;width=300px&amp;height=590&amp;colorscheme=light&amp;show_faces=true&amp;header=true&amp;stream=true&amp;show_border=false" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:300pxpx; height:590px;" allowTransparency="true"></iframe>
				</section>
				<section class="portal-side-panel">
					<div style="text-align: center;"><img src="portal/img/mskolsr.png"></img></div>
					<div style="text-align: center; padding-top: 5px;">ROK 2014 719 200,- EUR</div>
				</section>
				<section class="portal-side-panel">
					<header>Partneri</header>
					<div style="text-align: center; padding-top: 5px; height: 200px; vertical-align: middle; display: table-cell;"><img style="" src="portal/img/retic.png"></img></div>
					<div style="text-align: center; padding-top: 5px;">Hlavný reklamný partner reprezentačného družstva žien</div>
				</section>
			</div>
		</div>
	</div>
	<div id="footer-container">
		<header id="main-footer">
			Unionsoft, s.r.o, Všetky práva vyhradené
		</header>
	</div>
</body>
<script>
	$(function() {
		$('.x-portal-widget-showcase-view').each(function() {
			$(this).bind('showcase-next', function() {
				var idx = $(this).data('showcase-current') || 0;
				
				$(this).find('article').eq(idx).fadeOut();

				if (idx == $(this).find('article').length - 1) {
					idx = 0;
				} else {
					++idx;
				}

				$(this).find('article').eq(idx).fadeIn();

				$(this).data('showcase-current', idx);

				setTimeout(function() {
					$('.x-portal-widget-showcase-view').triggerHandler('showcase-next');
				}, 3000);
			});

		}).triggerHandler('showcase-next');

		$('.x-portal-widget-gallery').each(function(index) {

			$(this).find('.x-portal-widget-gallery-viewer-window-images').append(
				$(this).find('.x-portal-widget-gallery-thm > img').clone()
			);

			$(this).bind('gallery-next', function(e, idx) {
				
			});

			$(this).bind('gallery-show', function(e, idx) {
				$(this).find('.x-portal-widget-gallery-viewer').css('display', 'table-cell');
				$(this).data('gallery-current', idx);

				$(this).find('.x-portal-widget-gallery-viewer-window-images > img').eq(idx).fadeIn();
			});

			$(this).bind('gallery-next', function(e) {
				var idx = $(this).data('gallery-current');

				$(this).find('.x-portal-widget-gallery-viewer-window-images > img').eq(idx).fadeOut();

				if (idx == $(this).find('.x-portal-widget-gallery-viewer-window-images > img').length - 1) {
					idx = 0;
				} else {
					++idx;
				}

				$(this).find('.x-portal-widget-gallery-viewer-window-images > img').eq(idx).fadeIn();

				$(this).data('gallery-current', idx);
			});

			$(this).bind('gallery-prev', function(e) {
				var idx = $(this).data('gallery-current');

				$(this).find('.x-portal-widget-gallery-viewer-window-images > img').eq(idx).fadeOut();

				if (idx == 0) {
					idx = $(this).find('.x-portal-widget-gallery-viewer-window-images > img').length - 1;
				} else {
					--idx;
				}

				$(this).find('.x-portal-widget-gallery-viewer-window-images > img').eq(idx).fadeIn();

				$(this).data('gallery-current', idx);
			});

			$(this).bind('gallery-close', function(e, idx) {
				var idx = $(this).data('gallery-current');

				$(this).find('.x-portal-widget-gallery-viewer-window-images > img').eq(idx).hide();
				$(this).find('.x-portal-widget-gallery-viewer').fadeOut();
			});

			$(this).find('.x-portal-widget-gallery-close-btn').on('click', function() {
				$(this).closest('.x-portal-widget-gallery').triggerHandler('gallery-close');
			});

			$(this).find('.x-portal-widget-gallery-next-btn').on('click', function() {
				$(this).closest('.x-portal-widget-gallery').triggerHandler('gallery-next');
			});

			$(this).find('.x-portal-widget-gallery-prev-btn').on('click', function() {
				$(this).closest('.x-portal-widget-gallery').triggerHandler('gallery-prev');
			});

			$(this).find('.x-portal-widget-gallery-thm > img').each(function(idx){
				$(this).on('click', function(evt) {
					$(this).closest('.x-portal-widget-gallery').triggerHandler('gallery-show', [idx]);
				});
			});
		});

		$('.x-portal-competition-results').bind('competition-results-show', function() {
			var cid = $(this).find('.x-portal-competition-selector').val();
			var that = this;

			if (cid) {
				$.get('/competition/results/'+cid, function(data) {
					data.sort(function(a,b) { return b.points - a.points;});
					
					var table = $(that).find('table');

					table.empty();

					var counter = 0;
					for (var i in data) {

						var e = $('<tr><td style="text-align:right; padding-right: 5px;">'+ (++counter) +'</td><td style="font-weight: bold;">'+ data[i].name +'</td><td style="text-align: right;">'+data[i].matches+'z</td><td style="text-align: right;">'+data[i].points+'b</td><tr>');

						table.append(e);
					}
				});
			}
		});

		$('.x-portal-competition-results').find('.x-portal-competition-selector').on('change', function() {
			$(this).closest('.x-portal-competition-results').trigger('competition-results-show');
		});

		$('.x-portal-competition-matches').bind('competition-matches-show', function() {
			var cid = $(this).find('.x-portal-competition-selector').val();
			var that = this;

			if (cid) {
				$.get('/competition/matches/'+cid, function(data) {
					function formatDate(d) {
						return d.substr(6,2) + '.' +d.substr(4,2) + '.' + d.substr(0,4);
					}

					var table = $(that).find('table');

					table.empty();

					var lastDate = null;
					for (var i in data) {
						var currDate = formatDate(data[i].matchDate);
						if (lastDate !== currDate) {
							table.append('<tr><td colspan="3" class="x-portal-results-date">'+currDate+'</td></tr>');
							lastDate = currDate;
						}

						var e = $('<tr><td class="x-portal-results-left-club">' + data[i].homeName + '</td><td class="x-portal-results-hyphen">'+(data[i].fullTimeScoreHome || '-')+ '&nbsp;-&nbsp;'+(data[i].fullTimeScoreAway || '-')+'</td><td class="x-portal-results-right-club">' + data[i].guestName + '</td></tr>');

						if (data[i].webNo) {
							e.on('click', null, {webNo: data[i].webNo}, function(evt) {
								window.open('http://szhonline.sk/onlinex.aspx?cislo=' + evt.data.webNo);
							});
							e.addClass('x-portal-results-selectable');
						}
						table.append(e);
					}
				});
			}
		});

		$('.x-portal-competition-matches').find('.x-portal-competition-selector').on('change', function() {
			$(this).closest('.x-portal-competition-matches').trigger('competition-matches-show');
		});
		//get competitions
		$.get('/competition/list', function(data) {
			data.sort(function(a,b) {if (a.name > b.name) {return 1;} else if (a.name == b.name) {return 0;} else {return -1;};})
			$('.x-portal-competition-selector').empty();
			for (var i in data) {
				$('.x-portal-competition-selector').append('<option value="'+data[i].id+'">'+ data[i].name +'</option>').trigger('change');;
			}
		});
	});
</script>
</html>
